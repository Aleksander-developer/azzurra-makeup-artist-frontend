<!-- src/app/pages/portfolio/portfolio-detail/portfolio-detail.component.html -->
<section class="portfolio-detail-container">
  <button mat-icon-button class="back-button" routerLink="/portfolio">
    <mat-icon>arrow_back</mat-icon>
  </button>

  <div *ngIf="isLoading" class="loading-spinner">
    <mat-spinner></mat-spinner>
    <p>Caricamento dettagli portfolio...</p>
  </div>

  <div *ngIf="errorMessage" class="error-message">
    <mat-icon>error_outline</mat-icon> {{ errorMessage }}
  </div>

  <div *ngIf="portfolioItem && !isLoading" class="portfolio-content">
    <h1 class="item-title">{{ portfolioItem.title }}</h1>
    <h2 class="item-subtitle">{{ portfolioItem.subtitle }}</h2>
    <p class="item-category">Categoria: {{ portfolioItem.category }}</p>
    <p class="item-description">{{ portfolioItem.description }}</p>

    <!-- Sezione per visualizzare TUTTE le immagini -->
    <div class="image-gallery">
      <div *ngFor="let image of portfolioItem.images; let i = index" class="gallery-image-item">
        <!-- **MODIFICATO:** Aggiunto click event per aprire il fullscreen -->
        <img [src]="image.src || 'assets/placeholder.jpg'" [alt]="image.alt || portfolioItem.title" class="gallery-image"
             onerror="this.src='assets/placeholder.jpg'" (click)="openFullscreen(i)">
        <p *ngIf="image.description" class="image-description">{{ image.description }}</p>
        <!-- Opzionale: pulsante fullscreen sull'immagine della galleria -->
        <button mat-icon-button class="fullscreen-icon" (click)="openFullscreen(i)">
          <mat-icon>fullscreen</mat-icon>
        </button>
      </div>
    </div>

    <div class="item-dates">
      <p>Creato il: {{ portfolioItem.createdAt | date:'shortDate' }}</p>
      <p>Ultimo aggiornamento: {{ portfolioItem.updatedAt | date:'shortDate' }}</p>
    </div>
  </div>

  <div *ngIf="!portfolioItem && !isLoading && !errorMessage" class="no-item-found">
    <mat-icon>sentiment_dissatisfied</mat-icon> Elemento portfolio non trovato.
  </div>

  <!-- **NUOVO:** Overlay per la visualizzazione fullscreen -->
  <div *ngIf="showFullscreen && portfolioItem && portfolioItem.images && portfolioItem.images.length > 0" class="fullscreen-overlay" (click)="closeFullscreen()">
    <button mat-icon-button class="fullscreen-close-button" (click)="closeFullscreen(); $event.stopPropagation();">
      <mat-icon>close</mat-icon>
    </button>
    <button mat-icon-button class="fullscreen-nav-button prev" (click)="prevFullscreenImage(); $event.stopPropagation();">
      <mat-icon>chevron_left</mat-icon>
    </button>
    <img [src]="portfolioItem.images[fullscreenImageIndex].src || 'assets/placeholder.jpg'"
         [alt]="portfolioItem.images[fullscreenImageIndex].alt || portfolioItem.title"
         class="fullscreen-image"
         onerror="this.src='assets/placeholder.jpg'"
         (click)="$event.stopPropagation();"> <!-- Impedisce la chiusura al click sull'immagine -->
    <button mat-icon-button class="fullscreen-nav-button next" (click)="nextFullscreenImage(); $event.stopPropagation();">
      <mat-icon>chevron_right</mat-icon>
    </button>
  </div>
</section>
